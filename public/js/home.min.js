"use strict";!function(t,i){paper.install(i);var n={init:function(){this.initVariables(),this.initEvents(),this.initPage()},initVariables:function(){this.$welcomeModal=t("#welcome-modal"),this.$quiltOverlay=t("#canvas-overlay")},initEvents:function(){},initPage:function(){console.log("INIT"),quiltsList.init(),this.checkVisit()},checkVisit:function(){var t=Boolean(Cookies.get("visited"));if(console.log("visited",t),console.log("overlay",this.$quiltOverlay),!t){var i=this;this.$quiltOverlay.addClass("open"),this.$quiltOverlay.on("click",function(t){console.log("click",t),console.log(i.$quiltOverlay),i.$quiltOverlay.removeClass("open"),i.setVisited()}),this.$welcomeModal.modal("show"),setTimeout(function(){i.$welcomeModal.addClass("fade").modal("hide")},15e3),this.$welcomeModal.on("click",".get-started-link",this.setVisited)}},setVisited:function(){Cookies.set("visited","true",{expires:365})}};t(function(){n.init()})}(jQuery,window);var quiltsList=function(t){function i(){t("#grid-area").length&&(n(),o(),l(),e()),z.addClass("active")}function n(){if(T=document.getElementById("user-data")){var t=T.innerHTML.trim();if(!_.isEmpty(t))try{Y=JSON.parse(t)}catch(i){Y=t}}}function e(){var t=N.width()/4;W.width(t),Q.width(t*W.length+15),console.log("Thumbnails",W.length),console.log("Thumbnail Width",t)}function o(){G.find("a").on("click",c),$.on("scroll.canvas",m),$.on("click-patch",a)}function a(t){if(E)return!1;var i=t.patch,n="/quilts/view/"+i.quilt+"/"+i.uid;_.isEmpty(Y)?"new"===i.status&&(view.emit("onMouseUp"),L.find(".signin-link").attr("href","/account/login/?cb="+n),L.find(".signup-link").attr("href","/account/signup/?cb="+n),L.modal("show")):"mine"===i.status?(n="/patch/edit/"+i.uid,window.location.href=n):"new"===i.status&&(K.length?V.modal("show"):(n="/patch/start/"+i.uid,I.modal("show"),S.showDonationModal?F.find(".btn-secondary").on("click",function(){window.location.href=n}):I.find(".btn-primary").off("click").on("click",function(){window.location.href=n})),view.emit("onMouseUp"))}function l(){paper.setup("grid-area"),project.importSVG("/img/quilt-grid.svg",{expandShapes:!1,onLoad:p}),view.draw(),q()}function s(i,n){var e=t(n),o=e.is(z)?O:O.clone(),a=e.data("quilt-id"),l=e.find(".patch-data").text(),s=l?JSON.parse(l):[],c=J*i,d=O.bounds.width*i+O.bounds.width/2+2*c+J,r=new Point(d,O.bounds.height/2+J);console.log(a),o.position=r;new Quilt(o,a,s);e.is(z)||X.push(o)}function c(t){t.preventDefault(),w(t.currentTarget.getAttribute("data-index"))}function d(i){i.preventDefault(),"next"===t(i.currentTarget).data("value")?v():g()}function r(t){var i=t||0;P.removeClass("active"),P.filter(":eq("+i+")").addClass("active"),h()}function u(t){var i=t||0;W.removeClass("active"),G.filter(":eq("+i+")").addClass("active"),f(t)}function f(i){var n=W.find("[data-index="+i+"]"),e=window.innerWidth/2,o=Q.width(),a=parseInt(N.css("padding-left").replace("px","")),l=parseInt(t(".contents").css("margin-left").replace("px","")),s=n.offset().left-Q.offset().left+a+l,c=o-e,d=s-e+n.width()/2,d=d>0?d:0,d=d>c?c:d;TweenLite.to(N.get(0),.5,{scrollTo:{x:d},ease:Expo.easeInOut})}function h(){j.prop("disabled",!1),j.each(function(i,n){var e=t(n),o=e.data("value");("prev"===o&&0===R||"next"===o&&R===X.length-1)&&e.prop("disabled",!0)})}function p(t){b(t),O=t,X.push(t),B.each(s),M=new Group(X),M.pivot=U,M.clipped=!1,j.on("click",d),h()}function v(){R++,w(R,!0)}function g(){R--,w(R,!0)}function m(t){}function w(t,i){var n=x(),e=t||0,o=n*X.length,a=-Math.abs(n*e),l=o/M.bounds.width;M.scale=l,M.pivot=new Point(M.bounds.x-J,M.bounds.y),r(t),u(t),i?TweenLite.to(M.position,.5,{x:a,ease:Expo.easeInOut}):M.position.x=a,R=t}function b(t,i){var n=t.bounds.width,e=i||0,o=x()-2*J,a=J*e,l=o/n,s=o*e+o/2+2*a+J;t.scale(l),t.position=[s,t.bounds.height/2+J],i===X.length-1&&w(R)}function q(){k(),window.addEventListener("resize",_.debounce(y,250))}function y(t){t.preventDefault(),k(),e(),_.forEach(X,function(t,i){b(t,i)})}function k(){var t=x(),i=C(),n=new Size(t,i);view.viewSize=n}function x(){var t=getComputedStyle(A),i=A.clientWidth;return i-=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight),i-=parseFloat(t.marginLeft)+parseFloat(t.marginRight)}function C(){var t=getComputedStyle(A),i=A.clientHeight;return i-=parseFloat(t.paddingTop)+parseFloat(t.paddingBottom),i-=parseFloat(t.marginTop)+parseFloat(t.marginBottom)}var T,M,E,O,S={showDonationModal:!1},$=t(document),L=t("#login-modal").modal("hide"),F=t("#donation-modal").modal("hide"),I=t("#confirmation-modal").modal("hide"),V=t("#alert-modal").modal("hide"),B=t(".quilt-list .quilt"),D=t("#quilt-nav-container"),P=D.find(".quilt"),j=D.find(".quilt-nav"),z=B.filter(".active").length>0?B.filter(".active"):B.first(),N=t("#quilt-thumbnails-container"),Q=N.find("#quilt-thumbnails"),W=Q.children(),G=W.filter(":not(.new)"),H=utils.breakpoint(window.mobileMq),J="mobile"===H?12:32,R=0,U=new Point(0,0),A=document.getElementById("canvas-container"),K="",X=[],Y={};return{init:function(){i()},deinit:function(){},disable:function(t){function i(){return t.apply(this,arguments)}return i.toString=function(){return t.toString()},i}(function(){disable()})}}(jQuery);