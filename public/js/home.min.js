"use strict";!function(t,i){paper.install(i);var n={init:function(){this.initVariables(),this.initEvents(),this.initPage()},initVariables:function(){this.$welcomeModal=t("#welcome-modal"),this.$quiltOverlay=t("#canvas-overlay")},initEvents:function(){},initPage:function(){console.log("INIT"),quiltsList.init(),this.checkVisit()},checkVisit:function(){var t=Boolean(Cookies.get("visited"));if(console.log("visited",t),console.log("overlay",this.$quiltOverlay),!t){var i=this;this.$quiltOverlay.addClass("open"),this.$quiltOverlay.on("click",function(t){console.log("click",t),console.log(i.$quiltOverlay),i.$quiltOverlay.removeClass("open"),i.setVisited()}),this.$welcomeModal.modal("show"),setTimeout(function(){i.$welcomeModal.addClass("fade").modal("hide")},15e3),this.$welcomeModal.on("click",".get-started-link",this.setVisited)}},setVisited:function(){Cookies.set("visited","true",{expires:365})}};t(function(){n.init()})}(jQuery,window);var quiltsList=function(t){function i(){t("#grid-area").length&&(n(),o(),l(),e()),z.addClass("active")}function n(){if(T=document.getElementById("user-data")){var t=T.innerHTML.trim();if(!_.isEmpty(t))try{X=JSON.parse(t)}catch(i){X=t}}}function e(){var t=D.width()/4,i=15;Q.width(t),N.width(t*Q.length+i),console.log("Thumbnails",Q.length),console.log("Thumbnail Width",t)}function o(){W.find("a").on("click",c),$.on("scroll.canvas",m),$.on("click-patch",a)}function a(t){if(O)return!1;var i=t.patch,n="/quilts/view/"+i.quilt+"/"+i.uid;_.isEmpty(X)?"new"===i.status&&(view.emit("onMouseUp"),L.find(".signin-link").attr("href","/account/login/?cb="+n),L.find(".signup-link").attr("href","/account/signup/?cb="+n),L.modal("show")):"mine"===i.status?(n="/patch/edit/"+i.uid,window.location.href=n):"new"===i.status&&(A.length?I.modal("show"):(n="/patch/start/"+i.uid,F.modal("show"),M.find(".btn-secondary").on("click",function(){window.location.href=n})),view.emit("onMouseUp"))}function l(){paper.setup("grid-area"),project.importSVG("/img/quilt-grid.svg",{expandShapes:!1,onLoad:p}),view.draw(),q()}function s(i,n){var e=t(n),o=e.is(z)?S:S.clone(),a=e.data("quilt-id"),l=e.find(".patch-data").text(),s=l?JSON.parse(l):[],c=H*i,r=S.bounds.width*i+S.bounds.width/2+2*c+H,d=new Point(r,S.bounds.height/2+H);console.log(a),o.position=d;new Quilt(o,a,s);e.is(z)||K.push(o)}function c(t){t.preventDefault();var i=t.currentTarget.getAttribute("data-index");w(i)}function r(i){i.preventDefault();var n=t(i.currentTarget),e=n.data("value");"next"===e?v():g()}function d(t){var i=t||0;P.removeClass("active"),P.filter(":eq("+i+")").addClass("active"),h()}function u(t){var i=t||0;Q.removeClass("active"),W.filter(":eq("+i+")").addClass("active"),f(t)}function f(i){var n=Q.find("[data-index="+i+"]"),e=window.innerWidth/2,o=N.width(),a=parseInt(D.css("padding-left").replace("px","")),l=parseInt(t(".contents").css("margin-left").replace("px","")),s=n.offset().left-N.offset().left+a+l,c=o-e,r=s-e+n.width()/2,r=r>0?r:0,r=r>c?c:r;TweenLite.to(D.get(0),.5,{scrollTo:{x:r},ease:Expo.easeInOut})}function h(){j.prop("disabled",!1),j.each(function(i,n){var e=t(n),o=e.data("value");("prev"===o&&0===J||"next"===o&&J===K.length-1)&&e.prop("disabled",!0)})}function p(t){b(t),S=t,K.push(t),V.each(s),E=new Group(K),E.pivot=R,E.clipped=!1,j.on("click",r),h()}function v(){J++,w(J,!0)}function g(){J--,w(J,!0)}function m(t){}function w(t,i){var n=x(),e=t||0,o=n*K.length,a=-Math.abs(n*e),l=o/E.bounds.width;E.scale=l,E.pivot=new Point(E.bounds.x-H,E.bounds.y),d(t),u(t),i?TweenLite.to(E.position,.5,{x:a,ease:Expo.easeInOut}):E.position.x=a,J=t}function b(t,i){var n=t.bounds.width,e=i||0,o=x()-2*H,a=H*e,l=o/n,s=o*e+o/2+2*a+H;t.scale(l),t.position=[s,t.bounds.height/2+H],i===K.length-1&&w(J)}function q(){k(),window.addEventListener("resize",_.debounce(y,250))}function y(t){t.preventDefault(),k(),e(),_.forEach(K,function(t,i){b(t,i)})}function k(){var t=x(),i=C(),n=new Size(t,i);view.viewSize=n}function x(){var t=getComputedStyle(U),i=U.clientWidth;return i-=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight),i-=parseFloat(t.marginLeft)+parseFloat(t.marginRight)}function C(){var t=getComputedStyle(U),i=U.clientHeight;return i-=parseFloat(t.paddingTop)+parseFloat(t.paddingBottom),i-=parseFloat(t.marginTop)+parseFloat(t.marginBottom)}var T,E,O,S,$=t(document),L=t("#login-modal").modal("hide"),M=t("#donation-modal").modal("hide"),F=t("#confirmation-modal").modal("hide"),I=t("#alert-modal").modal("hide"),V=t(".quilt-list .quilt"),B=t("#quilt-nav-container"),P=B.find(".quilt"),j=B.find(".quilt-nav"),z=V.filter(".active").length>0?V.filter(".active"):V.first(),D=t("#quilt-thumbnails-container"),N=D.find("#quilt-thumbnails"),Q=N.children(),W=Q.filter(":not(.new)"),G=utils.breakpoint(window.mobileMq),H="mobile"===G?12:32,J=0,R=new Point(0,0),U=document.getElementById("canvas-container"),A="",K=[],X={};return{init:function(){i()},deinit:function(){},disable:function(t){function i(){return t.apply(this,arguments)}return i.toString=function(){return t.toString()},i}(function(){disable()})}}(jQuery);