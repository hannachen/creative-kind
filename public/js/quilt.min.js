"use strict";!function(t,n){paper.install(n),t(function(){quiltCanvas.init(),theme.init()})}(jQuery,window);var quiltCanvas=function(t){function n(){w.length&&(e(),o(),i())}function e(){if(y)var t=y.innerHTML;if(t&&(f=JSON.parse(t),_.forEach(f,function(t){"mine"===t.status&&(T=t.uid)})),E){var n=E.innerHTML.trim();_.isEmpty(n)||(F=JSON.parse(n))}}function i(){h.on("hide.bs.modal",function(t){console.log("TEST",t),m.modal("show"),p.attr("href","")}),t(document).on("click-patch",function(t){var n=t.patch,e="/quilts/view/"+S+"/"+n.uid;_.isEmpty(F)?"new"===n.status&&(g.find(".signin-link").attr("href","/account/login/?cb="+e),g.find(".signup-link").attr("href","/account/register/?cb="+e),g.modal("show")):(e="/patch/edit/"+n.uid,"mine"===n.status?window.location.href=e:"new"===n.status&&(T.length?v.modal("show"):(p.one("click",function(t){t.preventDefault(),console.log("HELLO??",t.currentTarget),h.modal("hide"),m.modal("show")}),h.modal("show"))))})}function o(){paper.setup("grid-area"),project.importSVG("/img/quilt-grid.svg",{expandShapes:!1,onLoad:a}),view.draw(),u()}function a(t){r(t),s=t;var n=new Quilt(t,S,f);if(console.log("NEW PATCH",L),L&&L.length){var e={uid:L,status:"new"};console.log("HELLO",L),n.emitClickEvent(e)}}function r(t){var n=t.bounds.x+t.bounds.width,e=t.bounds.y+t.bounds.height,i=l()/n,o=l()/2,a=e*i/2;t.scale(i),t.position=[o,a],view.draw()}function u(){d(),window.onresize=function(){d(),r(s)}}function d(){var t=l(),n=c(),e=new Size(t,n);view.viewSize=e}function l(){var t=getComputedStyle(b),n=b.clientWidth;return n-=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight),n-=parseFloat(t.marginLeft)+parseFloat(t.marginRight)}function c(){var t=getComputedStyle(b),n=b.clientHeight;return n-=parseFloat(t.paddingTop)+parseFloat(t.paddingBottom),n-=parseFloat(t.marginTop)+parseFloat(t.marginBottom)}var s,f,g=t("#login-modal").modal("hide"),m=t("#donation-modal").modal("hide"),h=t("#confirmation-modal").modal("hide"),p=h.find(".btn-primary"),v=t("#alert-modal").modal("hide"),w=t("#grid-area"),b=document.getElementById("canvas-container"),y=document.getElementById("quilt-data"),E=document.getElementById("user-data"),S=b.getAttribute("data-quilt-id")||"",L=y.getAttribute("data-new-patch")||"",T="",F={};return{init:function(){n()},deinit:function(){}}}(jQuery),theme=function(t){function n(){o.length>0&&!function(){var n=t(o.data("target")),a=o.find(".theme"),r=t(".selected-theme");o.on("init",function(t,e){i(n,r,a.get(e.currentSlide))}),o.on("afterChange",function(t,e,o){i(n,r,a.get(o))}),o.slick(),e()}()}function e(){t(".theme-form").on("submit",function(n){n.preventDefault();var e=n.currentTarget,i=e.getAttribute("action"),o=utils.seralizeObject(e);t.post(i,o,function(t){console.log(t)})})}function i(t,n,e){var i=e.getAttribute("data-id"),o=e.getAttribute("data-name");console.log(o,i),t.val(i),n.text(o),console.log(e)}var o=t(".theme-carousel");return{init:function(){n()},deinit:function(){}}}(jQuery);