"use strict";var quilt=function(e){function t(){if(paper.setup("grid-area"),b)var e=b.innerHTML;e&&(w=JSON.parse(e));var t=project.activeLayer;project.importSVG("/img/quilt-grid.svg",function(e){if(v=e,r(e),e.hasChildren()&&e.children.patches){e.hasChildren()&&e.children.start&&(C=e.children.start.children),e.hasChildren()&&e.children.taken&&(k=e.children.taken.children);var o=e.children,a=0;console.log(o.length),_.forEach(o,function(i){if(void 0!==i){var r=new paper.Group;switch(i.strokeScaling=!1,i.fillColor="#ffffff",i.data.uid=w[a].uid,i.data.status=w[a].status,i.copyTo(r),i.data.status){case"progress":C[a].visible=!1,k[a].visible=!0;break;case"mine":i.fillColor="#aab0ff";break;case"complete":i.fillColor="#ffcccc";break;case"new":default:C[a].visible=!0,k[a].visible=!1}C[a].copyTo(r),k[a].copyTo(r),r.on(n),r.copyTo(t),console.log(r),a++,a===o.length-1&&(e.children.start.remove(),e.children.taken.remove(),console.log(o.length),console.log(a))}})}}),view.draw(),l()}function n(){var e={};return e.click=o,Modernizr.touch||(e.mouseenter=a,e.mouseleave=i),e}function o(e){u=e.target.data,h.length?g.modal("show"):m.modal("show")}function a(e){e.target.opacity=.8}function i(e){e.target.opacity=1}function r(e){var t=e.bounds.x+e.bounds.width,n=e.bounds.y+e.bounds.height,o=d()/t,a=d()/2,i=n*o/2;e.scale(o),e.position=[a,i],view.draw()}function l(){c(),window.onresize=function(e){c(),r(v)}}function c(){var e=d(),t=s(),n=new Size(e,t);view.viewSize=n}function d(){var e=getComputedStyle(y),t=y.clientWidth;return t-=parseFloat(e.paddingLeft)+parseFloat(e.paddingRight),t-=parseFloat(e.marginLeft)+parseFloat(e.marginRight)}function s(){var e=getComputedStyle(y),t=y.clientHeight;return t-=parseFloat(e.paddingTop)+parseFloat(e.paddingBottom),t-=parseFloat(e.marginTop)+parseFloat(e.marginBottom)}var u,f=document.getElementsByClassName("status-new"),h=document.getElementsByClassName("status-mine"),m=e("#donation-modal").modal("hide"),p=e("#confirmation-modal").modal("hide"),g=e("#alert-modal").modal("hide");m.on("hidden.bs.modal",function(){p.modal("show")}),_.forEach(f,function(e){e.onclick=function(e){return e.preventDefault(),h.length?g.modal("show"):m.modal("show"),!1}});var v,w,y=document.getElementById("canvas-container"),b=document.getElementById("quilt-data"),C=[],k=[];return{init:function(){t()},deinit:function(){}}}(jQuery);paper.install(window),function(e,t){e(function(){quilt.init()})}(jQuery,window);