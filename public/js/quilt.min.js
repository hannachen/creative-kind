"use strict";paper.install(window),function(t,e){t(function(){quilt.init(),theme.init()})}(jQuery,window);var quilt=function(t){function e(){t("#grid-area").length&&n()}function n(){if(paper.setup("grid-area"),S)var t=S.innerHTML;if(t&&(y=JSON.parse(t),_.forEach(y,function(t){"mine"===t.status&&(E=t.uid)})),k){var e=k.innerHTML.trim();_.isEmpty(e)||(F=JSON.parse(e))}project.importSVG("/img/quilt-grid.svg",{expandShapes:!1,onLoad:i}),view.draw(),s()}function i(t){if(b=t,l(t),t.hasChildren()){var e=t.children;_.forEach(e,function(t,e){if(void 0!==t&&void 0!==t.hasChildren()){var n=void 0,i=void 0,r=void 0;switch(t.hasChildren()&&_.forEach(t.children,function(t){var e=a(t);switch(e){case"rectangle":n=t;break;case"path":i=t;break;case"circle":r=t}}),i.locked=!0,i.visible=!1,r.locked=!0,r.visible=!1,n.strokeScaling=!1,n.fillColor="#ffffff",n.data.uid=y[e].uid,n.data.status=y[e].status,_.isEmpty(F)||n.on(o()),n.data.status){case"progress":n.off(o()),n.fillColor="#cccccc";break;case"mine":n.fillColor="#aab0ff";break;case"complete":project.importSVG("/patch/svg/"+n.data.uid,function(t){t.rotate(-45),t.fitBounds(n.bounds),n.addChild(t)}),n.fillColor="#ffffff";break;case"new":default:E.length?n.off(o()):i.visible=!_.isEmpty(F)}}})}}function a(t){var e="";switch(console.log(t.className),t.className){case"Shape":e=t.type;break;case"Path":e=t.className.toLowerCase()}return e}function o(){var t={};return t.click=r,Modernizr.touch||(t.mouseenter=c,t.mouseleave=d),t}function r(t){h=t.target.data;var e="/patch/edit/"+h.uid;"mine"===h.status?window.location.href=e:E.length?w.modal("show"):(v.attr("href",e),g.modal("show"))}function c(t){t.target.opacity=.8}function d(t){t.target.opacity=1}function l(t){var e=t.bounds.x+t.bounds.width,n=t.bounds.y+t.bounds.height,i=f()/e,a=f()/2,o=n*i/2;t.scale(i),t.position=[a,o],view.draw()}function s(){u(),window.onresize=function(t){u(),l(b)}}function u(){var t=f(),e=m(),n=new Size(t,e);view.viewSize=n}function f(){var t=getComputedStyle(C),e=C.clientWidth;return e-=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight),e-=parseFloat(t.marginLeft)+parseFloat(t.marginRight)}function m(){var t=getComputedStyle(C),e=C.clientHeight;return e-=parseFloat(t.paddingTop)+parseFloat(t.paddingBottom),e-=parseFloat(t.marginTop)+parseFloat(t.marginBottom)}var h,g=t("#donation-modal").modal("hide"),p=t("#confirmation-modal").modal("hide"),v=p.find(".btn-primary"),w=t("#alert-modal").modal("hide");g.on("hidden.bs.modal",function(){p.modal("show")}),p.on("hide.bs.modal",function(){v.attr("href","")});var b,y,C=document.getElementById("canvas-container"),S=document.getElementById("quilt-data"),k=document.getElementById("user-data"),E="",F={};return{init:function(){e()},deinit:function(){}}}(jQuery),theme=function(t){function e(){a.length>0&&!function(){var e=t(a.data("target")),o=a.find(".theme"),r=t(".selected-theme");a.on("init",function(t,n){i(e,r,o.get(n.currentSlide))}),a.on("afterChange",function(t,n,a){i(e,r,o.get(a))}),a.slick(),n()}()}function n(){t(".theme-form").on("submit",function(e){e.preventDefault();var n=e.currentTarget,i=n.getAttribute("action"),a=utils.seralizeObject(n);t.post(i,a,function(t){console.log(t)})})}function i(t,e,n){var i=n.getAttribute("data-id"),a=n.getAttribute("data-name");console.log(a,i),t.val(i),e.text(a),console.log(n)}var a=t(".theme-carousel");return{init:function(){e()},deinit:function(){}}}(jQuery);