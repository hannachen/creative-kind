"use strict";paper.install(window),function(t,e){t(function(){quilt.init(),theme.init()})}(jQuery,window);var quilt=function(t){function e(){t("#grid-area").length&&i()}function i(){if(paper.setup("grid-area"),k)var t=k.innerHTML;if(t&&(b=JSON.parse(t),_.forEach(b,function(t){"mine"===t.status&&(S=t.uid)})),C){var e=C.innerHTML.trim();_.isEmpty(e)||(E=JSON.parse(e))}project.importSVG("/img/quilt-grid.svg",function(t){if(w=t,d(t),t.hasChildren()){var e=t.children;_.forEach(e,function(t,e){if(void 0!==t){var i=void 0,o=void 0,r=void 0;switch(t.hasChildren()&&_.forEach(t.children,function(t){var e=n(t);switch(e){case"rectangle":i=t;break;case"path":o=t;break;case"circle":r=t}}),o.locked=!0,o.visible=!1,r.locked=!0,r.visible=!1,i.strokeScaling=!1,i.fillColor="#ffffff",i.data.uid=b[e].uid,i.data.status=b[e].status,_.isEmpty(E)||i.on(a()),i.data.status){case"progress":i.off(a()),i.fillColor="#cccccc";break;case"mine":i.fillColor="#aab0ff";break;case"complete":project.importSVG("/patch/svg/"+i.data.uid,function(t){t.rotate(-45),t.fitBounds(i.bounds),i.addChild(t)}),i.fillColor="#ffffff";break;case"new":default:S.length?i.off(a()):o.visible=!_.isEmpty(E)}}})}}),view.draw(),u()}function n(t){var e="";switch(t.className){case"Shape":e=t.type;break;case"Path":e=t.className.toLowerCase()}return e}function a(){var t={};return t.click=o,Modernizr.touch||(t.mouseenter=r,t.mouseleave=c),t}function o(t){m=t.target.data;var e="/patch/edit/"+m.uid;"mine"===m.status?window.location.href=e:S.length?v.modal("show"):(p.attr("href",e),h.modal("show"))}function r(t){t.target.opacity=.8}function c(t){t.target.opacity=1}function d(t){var e=t.bounds.x+t.bounds.width,i=t.bounds.y+t.bounds.height,n=s()/e,a=s()/2,o=i*n/2;t.scale(n),t.position=[a,o],view.draw()}function u(){l(),window.onresize=function(t){l(),d(w)}}function l(){var t=s(),e=f(),i=new Size(t,e);view.viewSize=i}function s(){var t=getComputedStyle(y),e=y.clientWidth;return e-=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight),e-=parseFloat(t.marginLeft)+parseFloat(t.marginRight)}function f(){var t=getComputedStyle(y),e=y.clientHeight;return e-=parseFloat(t.paddingTop)+parseFloat(t.paddingBottom),e-=parseFloat(t.marginTop)+parseFloat(t.marginBottom)}var m,h=t("#donation-modal").modal("hide"),g=t("#confirmation-modal").modal("hide"),p=g.find(".btn-primary"),v=t("#alert-modal").modal("hide");h.on("hidden.bs.modal",function(){g.modal("show")}),g.on("hide.bs.modal",function(){p.attr("href","")});var w,b,y=document.getElementById("canvas-container"),k=document.getElementById("quilt-data"),C=document.getElementById("user-data"),S="",E={};return{init:function(){e()},deinit:function(){}}}(jQuery),theme=function(t){function e(){a.length>0&&!function(){var e=t(a.data("target")),o=a.find(".theme"),r=t(".selected-theme");a.on("init",function(t,i){n(e,r,o.get(i.currentSlide))}),a.on("afterChange",function(t,i,a){n(e,r,o.get(a))}),a.slick(),i()}()}function i(){t(".theme-form").on("submit",function(e){e.preventDefault();var i=e.currentTarget,n=i.getAttribute("action"),a=utils.seralizeObject(i);t.post(n,a,function(t){console.log(t)})})}function n(t,e,i){var n=i.getAttribute("data-id"),a=i.getAttribute("data-name");console.log(a,n),t.val(n),e.text(a),console.log(i)}var a=t(".theme-carousel");return{init:function(){e()},deinit:function(){}}}(jQuery);