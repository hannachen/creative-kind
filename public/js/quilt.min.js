"use strict";paper.install(window),function(t,e){t(function(){quilt.init()})}(jQuery,window);var quilt=function(t){function e(){var e=t(".theme-carousel"),i=e.find(".theme"),n=t(".selected-theme");e.slick(),e.on("afterChange",function(a,o,r){var c=i.get(r),d=t(e.data("target")),l=c.getAttribute("data-id"),s=c.getAttribute("data-name");console.log(s,l),d.val(l),n.text(s),console.log(c)}),t("#grid-area").length&&a()}function a(){if(paper.setup("grid-area"),k)var t=k.innerHTML;if(t&&(b=JSON.parse(t),_.forEach(b,function(t){"mine"===t.status&&(S=t.uid)})),C){var e=C.innerHTML.trim();_.isEmpty(e)||(E=JSON.parse(e))}project.importSVG("/img/quilt-grid.svg",function(t){if(w=t,d(t),t.hasChildren()){var e=t.children;_.forEach(e,function(t,e){if(void 0!==t){var a=void 0,o=void 0,r=void 0;if(t.hasChildren()&&_.forEach(t.children,function(t){var e=i(t);switch(e){case"rectangle":a=t;break;case"path":o=t;break;case"circle":r=t}}),o.locked=!0,o.visible=!1,r.locked=!0,r.visible=!1,a.strokeScaling=!1,a.fillColor="#ffffff",a.data.uid=b[e].uid,a.data.status=b[e].status,!_.isEmpty(E))switch(a.on(n()),a.data.status){case"progress":a.off(n()),a.fillColor="#cccccc";break;case"mine":a.fillColor="#aab0ff";break;case"complete":a.fillColor="#ffcccc";break;case"new":default:S.length?a.off(n()):o.visible=!0}}})}}),view.draw(),l()}function i(t){var e="";switch(t.className){case"Shape":e=t.type;break;case"Path":e=t.className.toLowerCase()}return e}function n(){var t={};return t.click=o,Modernizr.touch||(t.mouseenter=r,t.mouseleave=c),t}function o(t){m=t.target.data;var e="/patch/edit/"+m.uid;"mine"===m.status?window.location.href=e:S.length?v.modal("show"):(p.attr("href",e),h.modal("show"))}function r(t){t.target.opacity=.8}function c(t){t.target.opacity=1}function d(t){var e=t.bounds.x+t.bounds.width,a=t.bounds.y+t.bounds.height,i=u()/e,n=u()/2,o=a*i/2;t.scale(i),t.position=[n,o],view.draw()}function l(){s(),window.onresize=function(t){s(),d(w)}}function s(){var t=u(),e=f(),a=new Size(t,e);view.viewSize=a}function u(){var t=getComputedStyle(y),e=y.clientWidth;return e-=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight),e-=parseFloat(t.marginLeft)+parseFloat(t.marginRight)}function f(){var t=getComputedStyle(y),e=y.clientHeight;return e-=parseFloat(t.paddingTop)+parseFloat(t.paddingBottom),e-=parseFloat(t.marginTop)+parseFloat(t.marginBottom)}var m,h=t("#donation-modal").modal("hide"),g=t("#confirmation-modal").modal("hide"),p=g.find(".btn-primary"),v=t("#alert-modal").modal("hide");h.on("hidden.bs.modal",function(){g.modal("show")}),g.on("hide.bs.modal",function(){p.attr("href","")});var w,b,y=document.getElementById("canvas-container"),k=document.getElementById("quilt-data"),C=document.getElementById("user-data"),S="",E={};return{init:function(){e()},deinit:function(){}}}(jQuery);