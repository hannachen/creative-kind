"use strict";!function(t,n){paper.install(n),t(function(){t("#canvas-container").length&&quiltCanvas.init(),t(".invite").length&&invite.init(),theme.init(),invite.init()})}(jQuery,window);var quiltCanvas=function(t){function n(){S.length&&(i(),o(),e())}function i(){if(s=document.getElementById("canvas-container"),f=document.getElementById("quilt-data"),g=document.getElementById("user-data"),m=s.getAttribute("data-quilt-id")||"",p=f.getAttribute("data-new-patch")||"",f)var t=f.innerHTML;if(t&&(v=JSON.parse(t),_.forEach(v,function(t){"mine"===t.status&&(F=t.uid)})),g){var n=g.innerHTML.trim();_.isEmpty(n)||(C=JSON.parse(n))}}function e(){t(document).on("click-patch",function(t){var n=t.patch,i="/quilts/view/"+m+"/"+n.uid;_.isEmpty(C)?"new"===n.status&&(w.find(".signin-link").attr("href","/account/login/?cb="+i),w.find(".signup-link").attr("href","/account/register/?cb="+i),w.modal("show")):(i="/patch/edit/"+n.uid,"mine"===n.status?window.location.href=i:"new"===n.status&&(F.length?E.modal("show"):(i="/patch/start/"+n.uid,y.modal("show"),b.find(".btn-secondary").on("click",function(){window.location.href=i}))))})}function o(){paper.setup("grid-area"),project.importSVG("/img/quilt-grid.svg",{expandShapes:!1,onLoad:a}),view.draw(),u()}function a(t){r(t),h=t;var n=new Quilt(t,m,v);if(console.log("NEW PATCH",p),p&&p.length){var i={uid:p,status:"new"};console.log("HELLO",p),n.emitClickEvent(i)}}function r(t){var n=t.bounds.x+t.bounds.width,i=t.bounds.y+t.bounds.height,e=d()/n,o=d()/2,a=i*e/2;t.scale(e),t.position=[o,a],view.draw()}function u(){c(),window.onresize=function(){c(),r(h)}}function c(){var t=d(),n=l(),i=new Size(t,n);view.viewSize=i}function d(){var t=getComputedStyle(s),n=s.clientWidth;return n-=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight),n-=parseFloat(t.marginLeft)+parseFloat(t.marginRight)}function l(){var t=getComputedStyle(s),n=s.clientHeight;return n-=parseFloat(t.paddingTop)+parseFloat(t.paddingBottom),n-=parseFloat(t.marginTop)+parseFloat(t.marginBottom)}var s,f,g,m,p,h,v,w=t("#login-modal").modal("hide"),b=t("#donation-modal").modal("hide"),y=t("#confirmation-modal").modal("hide"),E=t("#alert-modal").modal("hide"),S=t("#grid-area"),F="",C={};return{init:function(){n()},deinit:function(){}}}(jQuery),invite=function(t){function n(){e.length>0&&(console.log("TEST"),e.tokenfield({delimiter:[","," ","\n","\r"]}),i())}function i(){}var e=t(".invite-field");return{init:function(){n()},deinit:function(){}}}(jQuery),theme=function(t){function n(){o.length>0&&!function(){var n=t(o.data("target")),a=o.find(".theme"),r=t(".selected-theme");o.on("init",function(t,i){e(n,r,a.get(i.currentSlide))}),o.on("afterChange",function(t,i,o){e(n,r,a.get(o))}),o.slick({mobileFirst:!0}),i()}()}function i(){t(".theme-form").on("submit",function(n){n.preventDefault();var i=n.currentTarget,e=i.getAttribute("action"),o=utils.seralizeObject(i);t.ajax(e,{type:"post",data:o,statusCode:{200:function(){},404:function(){alert("page not found")}}})})}function e(t,n,i){var e=i.getAttribute("data-id"),o=i.getAttribute("data-name");console.log(o,e),t.val(e),n.text(o),console.log(i)}var o=t(".theme-carousel");return{init:function(){n()},deinit:function(){}}}(jQuery);