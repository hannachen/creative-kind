'use strict';

var quiltEdit = function ($) {

  var $form = $('#quilts-form'),
      $editButton = $form.find('.edit-action'),
      $deleteButton = $form.find('.delete-action'),
      $typeSelect = $form.find('.type-select'),
      $confirmModal = $form.find('#delete-modal');

  function _init() {

    if ($editButton.length > 0) {
      $typeSelect.material_select();
      initEvents();
    }
  }

  function initEvents() {
    $editButton.on('click', onEditClick);
    $deleteButton.on('click', onDeleteClick);
    $typeSelect.on('change', onStatusChange);
    $form.on('change', '.edit-input', onInputChange);
  }

  function onEditClick(e) {
    e.preventDefault();
    var $target = $(e.currentTarget.getAttribute('data-target'));
    console.log('TARGET', $target);
    $target.toggleClass('edit-mode');
  }

  function onDeleteClick(e) {
    e.preventDefault();
    var $currentTarget = $(e.currentTarget),
        $target = $(e.currentTarget.getAttribute('data-target')),
        actionUrl = '/quilts/' + $target.data('id');
    $confirmModal.find('.btn-delete').on('click', onConfirmClick($currentTarget, actionUrl));
    $confirmModal.modal('show');
  }

  function onConfirmClick($target, actionUrl) {
    $.ajax(actionUrl, {
      type: 'delete',
      statusCode: {
        200: function _() {
          $target.closest('li').remove();
        },
        400: function _() {
          alert("page not found");
        }
      }
    });
    $confirmModal.modal('hide');
    $confirmModal.find('.btn-delete').off('click', onConfirmClick);
  }

  function onStatusChange(e) {
    e.preventDefault();
    console.log(e.currentTarget.value);
    var $target = $(e.currentTarget.getAttribute('data-target')),
        actionUrl = '/quilts/update/' + $target.data('id') + '/type/',
        formData = {
      'type': e.currentTarget.value
    };
    $.ajax(actionUrl, {
      type: 'patch',
      data: formData,
      statusCode: {
        200: function _() {},
        400: function _() {
          alert("not updated");
        }
      }
    });
  }

  function onInputChange(e) {
    var $target = $(e.currentTarget),
        newName = e.currentTarget.value,
        quiltId = e.currentTarget.getAttribute('data-id'),
        actionUrl = $form.attr('action') + '/' + quiltId,
        formData = {
      'title': newName
    };
    $.ajax(actionUrl, {
      type: 'post',
      data: formData,
      statusCode: {
        200: function _() {
          $target.next('.view-link').html(newName);
        },
        400: function _() {
          alert("not updated");
        }
      }
    });
  }

  return {
    init: function init() {
      _init();
    },
    deinit: function deinit() {}
  };
}(jQuery);
'use strict';

(function ($, window) {

  $(function () {
    quiltEdit.init();
  });
})(jQuery, window);
//# sourceMappingURL=maps/account.js.map
